# 三国杀单机版 - 快速开始

## 项目结构

```
Sanguosha/
├── main.py                 # 程序入口
├── run.sh                  # 启动脚本
├── test_engine.py          # 引擎测试
├── requirements.txt        # 依赖列表
├── engine/                 # 游戏引擎（纯逻辑）
│   ├── game.py            # 游戏主控
│   ├── player.py          # 玩家
│   ├── deck.py            # 牌堆
│   ├── hero.py            # 武将系统
│   ├── events.py          # 事件总线
│   └── cards/             # 卡牌系统
│       ├── basic.py       # 基本牌（杀、闪、桃）
│       └── trick.py       # 锦囊牌
└── ui/                     # 用户界面（PySide6）
    ├── app.py             # 主窗口
    └── table/
        └── scene.py       # 游戏场景视图
```

## 运行游戏

### 方法1：使用启动脚本
```bash
./run.sh
```

### 方法2：直接运行
```bash
source .venv/bin/activate
python main.py
```

## 游戏操作

### 界面说明
- **中央区域**：游戏桌面，圆形布局显示所有玩家
- **底部**：当前玩家的手牌
- **右侧**：
  - 游戏信息：当前玩家、阶段、牌堆状态
  - 操作按钮：摸牌、出牌、结束回合
  - 游戏日志：记录所有操作

### 基本流程
1. **选择手牌**：点击底部的手牌，被选中的牌会高亮显示
2. **选择目标**：点击圆环中的玩家面板（如果需要目标）
3. **出牌**：点击"出牌"按钮
4. **结束回合**：点击"结束回合"进入下一个玩家的回合

### 卡牌使用规则
- **杀**：需要选择一个目标玩家，每回合限用一次
- **闪**：防御牌，暂未实现响应机制
- **桃**：体力未满时可用，回复1点体力
- **过河拆桥**：选择目标，弃置其一张牌
- **顺手牵羊**：选择目标，获得其一张牌
- **无中生有**：不需要目标，摸2张牌
- **决斗**：选择目标，造成1点伤害

## 已实现功能

### 核心系统
- ✅ 游戏引擎（回合管理、阶段流转）
- ✅ 牌堆系统（洗牌、抽牌、弃牌）
- ✅ 玩家系统（体力、手牌、装备）
- ✅ 事件系统（EventBus）

### 卡牌系统
- ✅ 基本牌：杀、闪、桃（带花色点数）
- ✅ 锦囊牌：过河拆桥、顺手牵羊、无中生有、决斗
- ✅ 完整牌堆（基本牌53张 + 部分锦囊）

### 武将系统
- ✅ 武将基类和技能框架
- ✅ 标准版9名武将（曹操、刘备、孙权、关羽、张飞、赵云、诸葛亮、华佗、吕布）
- ⏳ 武将技能效果（框架已就绪，待实现具体效果）

### 界面系统
- ✅ 主窗口（PySide6）
- ✅ 游戏场景（圆形布局）
- ✅ 卡牌可视化（花色、点数、牌名）
- ✅ 交互选择（点击选牌/选目标）
- ✅ 游戏日志
- ✅ 状态信息显示

## 待扩展功能

### 短期（1-2周）
- [ ] 响应机制（出杀需要闪、无懈可击等）
- [ ] 延时锦囊（乐不思蜀、闪电）
- [ ] 装备牌（武器、防具、坐骑）
- [ ] 武将技能实现（优先常见技能）
- [ ] 距离计算与攻击范围

### 中期（3-4周）
- [ ] 身份局完整规则
- [ ] AI对手
- [ ] 更多锦囊牌（万箭齐发、南蛮入侵、桃园结义、五谷丰登等）
- [ ] 判定机制
- [ ] 音效与动画

### 长期
- [ ] 完整25名武将及技能
- [ ] 保存/加载游戏
- [ ] 卡牌美术资源
- [ ] 多人联机（可选）

## 测试

### 运行引擎测试
```bash
./.venv/bin/python test_engine.py
```

测试包括：
- 游戏初始化
- 武将分配
- 摸牌与出牌
- 回合切换

## 技术栈

- **语言**：Python 3.9+
- **GUI框架**：PySide6 (Qt6)
- **架构**：MVC + 事件驱动
- **平台**：macOS（可扩展到Windows/Linux）

## 开发建议

### 添加新卡牌
1. 在 `engine/cards/` 下创建卡牌类
2. 继承 `Card` 或 `TrickCard`
3. 实现 `use()` 和 `can_use()` 方法
4. 在 `Deck.build_standard()` 中添加到牌堆

### 添加新武将
1. 在 `engine/hero.py` 中创建武将类
2. 继承 `Hero`，设置势力和体力
3. 添加技能到 `skills` 列表
4. 将类添加到 `STANDARD_HEROES`

### 实现技能
1. 创建 `Skill` 子类
2. 实现 `can_trigger()` 判断触发时机
3. 实现 `trigger()` 执行效果
4. 在合适的事件处理中调用

## 许可

本项目仅供学习交流使用。

---

**开始游戏，享受三国杀的乐趣吧！** 🎮

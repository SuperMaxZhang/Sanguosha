# 三国杀单机版 🎴

基于 Python + PySide6 开发的三国杀单机游戏，支持 1 个玩家 + 3 个 AI 对手。

![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)
![PySide6](https://img.shields.io/badge/PySide6-6.0+-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

## ✨ 特性

- 🎮 **完整的游戏规则** - 摸牌、出牌、弃牌、回合流程
- 🤖 **智能 AI 对手** - 自动决策、优先级策略
- 🎯 **身份系统** - 主公、忠臣、反贼、内奸
- ⚔️ **武将技能** - 曹操奸雄、张飞咆哮、赵云龙胆等
- 🎬 **精美动画** - 出牌动画、箭头指向、血量爱心显示
- 🃏 **完整卡牌** - 基本牌（杀、闪、桃）+ 锦囊牌（过河拆桥、顺手牵羊、无中生有、决斗）
- 💀 **死亡判定** - 自动使用桃、立即死亡检查、胜利判定
- 🎨 **现代界面** - 圆形布局、交互式手牌、实时状态显示

## 🎯 游戏截图

游戏采用圆形布局，中间显示出牌动画，右侧显示游戏日志和操作按钮。

### 玩家面板
- 显示武将名称、身份、血量（爱心）
- 显示武将技能
- 实时更新手牌数量
- 死亡后面板变灰

### 出牌动画
- 卡牌显示在桌面中央
- 箭头指向攻击目标
- 闪避动画显示
- 2秒后自动消失

## 🚀 快速开始

### 环境要求

- macOS / Linux / Windows
- Python 3.9+
- PySide6

### 安装

```bash
# 克隆项目
git clone git@github.com:SuperMaxZhang/Sanguosha.git
cd Sanguosha

# 创建虚拟环境
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

### 运行

```bash
# macOS/Linux
./run.sh

# 或直接运行
python main.py
```

## 🎮 游戏规则

### 身份系统

- **主公** - 需要消灭所有反贼和内奸，体力 +1
- **忠臣** - 保护主公，协助主公获胜
- **反贼** - 击杀主公获胜
- **内奸** - 最后存活者获胜

### 胜利条件

- **主公阵营获胜** - 反贼全部死亡 + 内奸全部死亡
- **反贼获胜** - 主公死亡且还有反贼存活
- **内奸获胜** - 只剩内奸一人存活

### 回合流程

1. **摸牌阶段** - 自动摸 2 张牌
2. **出牌阶段** - 使用手牌（杀每回合限 1 次，张飞除外）
3. **弃牌阶段** - 手牌数超过体力值时自动弃牌

## 🦸 武将技能

| 武将 | 势力 | 体力 | 技能 | 说明 |
|------|------|------|------|------|
| 曹操 | 魏 | 4 | 奸雄 | 受到伤害后获得造成伤害的牌 |
| 张飞 | 蜀 | 4 | 咆哮 | 出牌阶段可无限使用【杀】 |
| 赵云 | 蜀 | 4 | 龙胆 | 杀当闪、闪当杀使用 |
| 诸葛亮 | 蜀 | 3 | 观星 | 准备阶段观看牌堆顶的牌 |
| 华佗 | 群 | 3 | 青囊 | 弃一张牌令角色回复 1 体力 |
| 吕布 | 群 | 4 | 无双 | 使用杀时目标需出两张闪 |
| 刘备 | 蜀 | 4 | 仁德 | - |
| 关羽 | 蜀 | 4 | 武圣 | - |
| 孙权 | 吴 | 4 | 制衡 | - |

## 🃏 卡牌系统

### 基本牌
- **杀** - 攻击目标，造成 1 点伤害（可被闪抵消）
- **闪** - 抵消杀的伤害
- **桃** - 回复 1 点体力

### 锦囊牌
- **过河拆桥** - 弃置目标一张牌
- **顺手牵羊** - 获得目标一张手牌
- **无中生有** - 摸 2 张牌
- **决斗** - 与目标决斗，造成 1 点伤害

## 🎯 操作说明

### 键盘快捷键
- `U` - 出牌
- `E` - 结束回合
- `R` - 重新开始

### 出牌流程
1. 点击选择手牌（高亮显示）
2. 点击选择目标玩家（如需要）
3. 点击"出牌"按钮或按 `U`
4. 观看动画效果
5. 等待 AI 自动完成回合

## 🤖 AI 系统

AI 采用优先级决策策略：

1. **优先回血** - 体力不满时使用桃
2. **优先摸牌** - 使用无中生有
3. **控场锦囊** - 使用过河拆桥、顺手牵羊
4. **主动攻击** - 使用杀攻击敌方
5. **决斗伤害** - 使用决斗造成伤害

## 📁 项目结构

```
Sanguosha/
├── engine/              # 游戏引擎
│   ├── game.py         # 游戏主控
│   ├── player.py       # 玩家类
│   ├── deck.py         # 牌堆
│   ├── hero.py         # 武将和技能
│   ├── ai.py           # AI 控制器
│   ├── events.py       # 事件系统
│   └── cards/          # 卡牌
│       ├── basic.py    # 基本牌
│       └── trick.py    # 锦囊牌
├── ui/                  # 用户界面
│   ├── app.py          # 主窗口
│   ├── dialogs.py      # 选择对话框
│   └── table/          # 游戏桌面
│       └── scene.py    # 场景渲染
├── main.py             # 程序入口
├── requirements.txt    # 依赖列表
└── run.sh             # 启动脚本
```

## 🔧 技术栈

- **语言** - Python 3.9+
- **GUI 框架** - PySide6 (Qt6)
- **架构** - MVC + 事件驱动
- **渲染** - QGraphicsView/QGraphicsScene

## 📝 开发路线

- [x] 基础游戏引擎
- [x] 卡牌系统
- [x] AI 系统
- [x] 图形界面
- [x] 出牌动画
- [x] 武将技能系统
- [x] 身份系统
- [ ] 装备牌系统
- [ ] 延时锦囊
- [ ] 武将技能完善
- [ ] 距离计算
- [ ] 联机对战

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

## 👨‍💻 作者

SuperMaxZhang

---

⭐ 如果这个项目对你有帮助，请给个 Star！
